function setMarkers(o,e){console.log("locations:",e);for(var n=0;n<e.length;n++){var a=new google.maps.Marker({position:e[n].latLng,map:o,title:e[n].name,visible:!0});markerArray[n]=a,attachInfotext(a,n)}}function attachInfotext(o,e){var n=new google.maps.InfoWindow({content:locations[e].infoWindowContent,maxWidth:200});infowindowArray[e]=n,google.maps.event.addListener(o,"click",function(){closeInfoWindows(),infowindowArray[e].open(markerArray[e].get("map"),markerArray[e])})}function initialize(){var o=document.getElementById("map-canvas"),e={center:new google.maps.LatLng(35.64222479297878,-120.68633100585936),zoom:11,mapTypeId:google.maps.MapTypeId.ROADMAP},n=new google.maps.Map(o,e);return n}var locations=initialData_js,map,placeTypes=["All"],markerArray=[],infowindowArray=[],ko,console,google,show,sortNames=function(){locations.sort(function(o,e){return o.name>e.name?1:o.name<e.name?-1:0})};sortNames();var computeShowArray=function(){for(var o,e=0;e<locations.length;e++){show=["All"];for(var n=0;n<locations[e].infoAry.length;n++)o=locations[e].infoAry[n].type,show.push(o),-1===placeTypes.indexOf(o)&&placeTypes.push(o);locations[e].show=show,locations[e].index=e,placeTypes.sort()}};computeShowArray();var computeContentString=function(){for(var o=0;o<locations.length;o++){for(var e="",n=0;n<locations[o].infoAry.length;n++)e+="<p>",e+=locations[o].infoAry[n].type+": ",e+=locations[o].infoAry[n].infoText+"</p>";locations[o].infoWindowContent=e,locations[o].latLng=new google.maps.LatLng(locations[o].lat,locations[o].lng)}};computeContentString();var closeInfoWindows=function(){for(var o=0;o<markerArray.length;o++)infowindowArray[o].close(markerArray[o].get("map"),markerArray[o])},toggleBounce=function(o){var e=markerArray[o];null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){toggleBounce(o)},2100))},MyViewModel=function(o){"use strict";var e=this;e.placeTypes=ko.observableArray(placeTypes),e.selectedPlaceType=ko.observableArray(["All"]),e.searchText=ko.observable(""),e.places=ko.observableArray(ko.utils.arrayMap(o,function(o){return{name:o.name,index:o.index,url:o.url,addr1:o.addr1,addr2:o.addr2,lat:o.lat,lng:o.lng,infoAry:ko.observableArray(o.infoAry),show:ko.observableArray(o.show),infoWindowContent:o.infoWindowContent}})),e.includesSelectedType=function(o,n,a){return a.indexOf(o()[0])>=0&&(e.showMarker(n),-1!==e.places()[n].name.indexOf(e.searchText()))?!0:(e.hideMarker(n),!1)},e.searchForText=function(){console.log("self.searchText:",e.searchText());for(var o=0;o<e.places().length;o++)-1!==e.places()[o].show.indexOf(e.selectedPlaceType()[0])&&-1!==e.places()[o].name.indexOf(e.searchText())&&console.log("match: ",e.searchText())},e.showMarker=function(o){markerArray[o].setMap(map)},e.hideMarker=function(o){markerArray[o].setMap(null);for(var o=0;o<markerArray.length;o++)infowindowArray[o].close(markerArray[o].get("map"),markerArray[o])},e.closeInfoWindows=function(){for(var o=0;o<markerArray.length;o++)infowindowArray[o].close(markerArray[o].get("map"),markerArray[o])},e.showMarkers=function(){},e.showInfoWindow=function(o){console.log("ran showIfoWindos"),e.closeInfoWindows(),infowindowArray[o].open(markerArray[o].get("map"),markerArray[o]),toggleBounce(o)}};$(document).ready(function(){map=initialize(),setMarkers(map,locations),ko.applyBindings(new MyViewModel(locations)),window.setTimeout(function(){closeInfoWindows()},1e3)});